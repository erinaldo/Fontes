#Include "Rwmake.ch"
#Include "TopConn.ch"

/*

Ŀ
Funo      MT103PN  Autor  Leonardo Soncin        Data 28/11/2006 
Ĵ
          Esta rotina valida a database para incluir a NFE.            
Ĵ
Uso       Especifico CSU                                               
ٱ


*/

User Function MT103PN()

Local lRet	   := .t.
Local dDatFech := GetNewPar("MV_XMESNFE","")

If dDataBase < dDatFech
	lRet := .f.
	cTxtBlq := "Incluir este documento a partir de "+Dtoc( dDatFech )
	Aviso("Data Base do Sistema",cTxtBlq,{"&Fechar"},3,"CONTROLE DE FECHAMENTO",,"PCOLOCK")
EndIf

If lRet
	If dDataBase > Date()
		lRet := .f.
		cTxtBlq := "A data base do sistema  superior  data do dia de hoje. Operao no permitida!"
		Aviso("Data Base do Sistema",cTxtBlq,{"&Fechar"},3,"MAIOR QUE A DATA DO DIA",,"PCOLOCK")
	Else
		If dDEmissao > Date() // Teoricamente o proprio sistema nao permite esta opcao. Mas para garantir....
			lRet := .f.
			cTxtBlq := "A data de emisso  superior  data do dia de hoje. Operao no permitida!"
			Aviso("Data Base do Sistema",cTxtBlq,{"&Fechar"},3,"MAIOR QUE A DATA DO DIA",,"PCOLOCK")
		EndIf  
	EndIf
EndIf

Return lRet