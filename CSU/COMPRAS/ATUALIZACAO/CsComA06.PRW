#INCLUDE 'RWMAKE.CH'
/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออออออหอออออออัอออออออออออออออออออหออออออัออออออออออปฑฑ
ฑฑบPrograma  ณ CSCOMA06.PRW บ Autor ณ Flavio Novaes     บ Data ณ 30/03/07 บฑฑ
ฑฑฬออออออออออุออออออออออออออสอออออออฯอออออออออออออออออออสออออออฯออออออออออนฑฑ
ฑฑบDescricao ณ Cadastro de Liberacoes para Inclusao de Notas Fiscais de   บฑฑ
ฑฑบ          ณ Entrada: Tabela ZU7.                                       บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ A CSU decidiu bloquear a Inclusao de Notas Fiscais de En-  บฑฑ
ฑฑบ          ณ trada para as seguintes situacoes: 1) Quando os Impostos   บฑฑ
ฑฑบ          ณ de ISS e/ou INSS estiverem atrasados. 2) Quando o Titulo a บฑฑ
ฑฑบ          ณ Pagar gerado pela Nota Fiscal de Entrada tiver vencimento  บฑฑ
ฑฑบ          ณ Fora do Prazo estabelecido pela CSU (parametro MV_DIAVENC).บฑฑ
ฑฑบ          ณ Essa rotina permite cadastrar as excecoes, ou seja, os For-บฑฑ
ฑฑบ          ณ necedores que estiverem ativos nessa tabela tem permissao  บฑฑ
ฑฑบ          ณ para entrar com a Nota Fiscal.                             บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
USER FUNCTION CSCOMA06()
LOCAL cTitulo   := 'Cadastro de Libera็๕es.'
LOCAL aCor      := {	{'ZU7->ZU7_ATIVO == .T.','BR_VERDE'},;		// Lib. Ativa
						{'ZU7->ZU7_ATIVO == .F.','BR_VERMELHO'}}	// Lib. Inativa
cCadastro := 'Cadastro de Libera็๕es.'
aRotina   := menudef()

//{	{'Pesquisar','AXPESQUI',0,1},;
//				{'Visualizar','AXVISUAL',0,2},;
//				{'Liberar','AXINCLUI',0,3},;
//				{'Bloquear','U_CSCOMA6A()',0,4},;
//				{'Legenda','U_CSCOMA6L()',0,9}}
MBROWSE(,,,,'ZU7',,,,,,aCor)
RETURN
/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออออออหอออออออัอออออออออออออออออออหออออออัออออออออออปฑฑ
ฑฑบPrograma  ณ CSCOMA6A     บ Autor ณ Flavio Novaes     บ Data ณ 30/03/07 บฑฑ
ฑฑฬออออออออออุออออออออออออออสอออออออฯอออออออออออออออออออสออออออฯออออออออออนฑฑ
ฑฑบDescricao ณ Cadastro de Liberacoes para Inclusao de Notas Fiscais de   บฑฑ
ฑฑบ          ณ Entrada: Tabela ZU7.                                       บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ A CSU decidiu bloquear a Inclusao de Notas Fiscais de En-  บฑฑ
ฑฑบ          ณ trada para as seguintes situacoes: 1) Quando os Impostos   บฑฑ
ฑฑบ          ณ de ISS e/ou INSS estiverem atrasados. 2) Quando o Titulo a บฑฑ
ฑฑบ          ณ Pagar gerado pela Nota Fiscal de Entrada tiver vencimento  บฑฑ
ฑฑบ          ณ Fora do Prazo estabelecido pela CSU (parametro MV_DIAVENC).บฑฑ
ฑฑบ          ณ Essa rotina permite cadastrar as excecoes, ou seja, os For-บฑฑ
ฑฑบ          ณ necedores que estiverem ativos nessa tabela tem permissao  บฑฑ
ฑฑบ          ณ para entrar com a Nota Fiscal.                             บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
USER FUNCTION CSCOMA6A()
IF ZU7->ZU7_ATIVO
	_nOpc := AxAltera('ZU7',ZU7->(RECNO()),4,,,,,,,,)
	IF _nOpc == 1 .AND. !ZU7->ZU7_ATIVO
		IF RECLOCK('ZU7',.F.)
			REPLACE ZU7_DTBLOQ WITH dDataBase,;
					ZU7_HRBLOQ WITH TIME(),;
					ZU7_USBLOQ WITH SUBSTR(cUsuario,7,15)
			MSUNLOCK()
		ENDIF
	ENDIF
ENDIF
RETURN
/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออออออหอออออออัอออออออออออออออออออหออออออัออออออออออปฑฑ
ฑฑบPrograma  ณ CSCOMA6L     บ Autor ณ Flavio Novaes     บ Data ณ 30/03/07 บฑฑ
ฑฑฬออออออออออุออออออออออออออสอออออออฯอออออออออออออออออออสออออออฯออออออออออนฑฑ
ฑฑบDescricao ณ Cadastro de Liberacoes para Inclusao de Notas Fiscais de   บฑฑ
ฑฑบ          ณ Entrada: Tabela ZU7.                                       บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ A CSU decidiu bloquear a Inclusao de Notas Fiscais de En-  บฑฑ
ฑฑบ          ณ trada para as seguintes situacoes: 1) Quando os Impostos   บฑฑ
ฑฑบ          ณ de ISS e/ou INSS estiverem atrasados. 2) Quando o Titulo a บฑฑ
ฑฑบ          ณ Pagar gerado pela Nota Fiscal de Entrada tiver vencimento  บฑฑ
ฑฑบ          ณ Fora do Prazo estabelecido pela CSU (parametro MV_DIAVENC).บฑฑ
ฑฑบ          ณ Essa rotina permite cadastrar as excecoes, ou seja, os For-บฑฑ
ฑฑบ          ณ necedores que estiverem ativos nessa tabela tem permissao  บฑฑ
ฑฑบ          ณ para entrar com a Nota Fiscal.                             บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
USER FUNCTION CSCOMA6L()
LOCAL _aLegenda := {}
aAdd(_aLegenda,{'BR_VERDE','Libera็ใo Ativa' })
aAdd(_aLegenda,{'BR_VERMELHO','Libera็ใo Inativa'})
BRWLEGENDA('Cadastro de Libera็๕es.','Legenda',_aLegenda)
RETURN
/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑฺฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤยฤฤฤฤฤฤยฤฤฤฤฤฤฤฤฤฤฤฤฟฑฑ
ฑฑณ Funcao     ณ FVALUSER()   ณ Autor ณ Flavio Novaes   ณ Data ณ 23/04/2007 ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Descricao  ณ Funcao para Validar o Codigo do Usuario no SIGA, utilizada ณฑฑ
ฑฑณ            ณ na Validacao do Usuario do Campo ZU7->ZU7_SOLIC.           ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Uso        ณ Exclusivo CSU.                                             ณฑฑ
ฑฑรฤฤฤฤฤฤฤฤฤฤฤฤลฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤดฑฑ
ฑฑณ Observacao ณ                                                            ณฑฑ
ฑฑภฤฤฤฤฤฤฤฤฤฤฤฤมฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤูฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
USER FUNCTION FVALUSER(_cNomeUsr)
LOCAL _lRet := .T.
//Alterado por Flavio Novaes em 11/06/07 pois estava muito lento.
//LOCAL _aUsuario := ALLUSERS()
//LOCAL _nPos     := aScan(_aUsuario,{|x|ALLTRIM(x[1][1])==ALLTRIM(_cCodUsr)})
//IF !_nPos > 0
//	_lRet := .F.
//	AVISO('Aten็ใo !','Usuแrio Nใo Cadastrado.',{'Ok'},1,'Cadastro de Usuแrios')
//ENDIF
PSWORDER(2)	// Nome do Usuario (Login do Usuario do Protheus)
IF !PSWSEEK(_cNomeUsr)
	_lRet := .F.
	AVISO('Aten็ใo !','Matrํcula do Usuแrio ('+ALLTRIM(_cNomeUsr)+') NรO Cadastrada!',{'OK'},1,'Usuแrio NรO Cadastrado!')
ENDIF
RETURN(_lRet)


/*

ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
ฑฑษออออออออออัออออออออออหอออออออัออออออออออออออออออออหออออออัอออออออออออออปฑฑ
ฑฑบPrograma  ณ MenuDEF  บ Autor ณEduardo de Souza    บ Data ณ12/Jan/2007  บฑฑ
ฑฑฬออออออออออุออออออออออสอออออออฯออออออออออออออออออออสออออออฯอออออออออออออนฑฑ
ฑฑบDescricao ณ Implementa menu funcional                                  บฑฑ
ฑฑฬออออออออออุออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออนฑฑ
ฑฑบUso       ณ Menus                                                      บฑฑ
ฑฑศออออออออออฯออออออออออออออออออออออออออออออออออออออออออออออออออออออออออออผฑฑ
ฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑฑ
฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿฿
*/
//ฺฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฟ
//ณ Define Array contendo as Rotinas a executar do programa      ณ
//ณ ----------- Elementos contidos por dimensao ------------     ณ
//ณ 1. Nome a aparecer no cabecalho                              ณ
//ณ 2. Nome da Rotina associada                                  ณ
//ณ 3. Usado pela rotina                                         ณ
//ณ 4. Tipo de Transao a ser efetuada                          ณ
//ณ    1 - Pesquisa e Posiciona em um Banco de Dados             ณ
//ณ    2 - Simplesmente Mostra os Campos                         ณ
//ณ    3 - Inclui registros no Bancos de Dados                   ณ
//ณ    4 - Altera o registro corrente                            ณ
//ณ    5 - Remove o registro corrente do Banco de Dados          ณ
//ณ    3 - Duplica o registro corrente do Banco de Dados         ณ
//ภฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤฤู
Static Function MenuDef()
Local aRotina   := {	{'Pesquisar','AXPESQUI',0,1},;
				{'Visualizar','AXVISUAL',0,2},;
				{'Liberar','AXINCLUI',0,3},;
				{'Bloquear','U_CSCOMA6A()',0,4},;
				{'Legenda','U_CSCOMA6L()',0,9}}
Return aRotina
